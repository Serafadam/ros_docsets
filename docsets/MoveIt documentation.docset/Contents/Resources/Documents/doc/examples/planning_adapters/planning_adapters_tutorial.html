<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Planning Adapter Tutorials &mdash; MoveIt documentation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/override.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="canonical" href="https://moveit.picknik.ai/rolling/doc/examples/planning_adapters/planning_adapters_tutorial.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Warehouse - Persistent Scenes and States" href="../persistent_scenes_and_states/persistent_scenes_and_states.html" />
    <link rel="prev" title="Pilz Industrial Motion Planner" href="../pilz_industrial_motion_planner/pilz_industrial_motion_planner.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html">
            <img src="../../../_static/rolling-small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples.html#movegroup-ros-wrappers-in-c">MoveGroup - ROS Wrappers in C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#using-moveit-directly-through-the-c-api">Using MoveIt Directly Through the C++ API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#integration-with-a-new-robot">Integration with a New Robot</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#configuration">Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../kinematics_configuration/kinematics_configuration_tutorial.html">Kinematics Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../custom_constraint_samplers/custom_constraint_samplers_tutorial.html">Custom Constraint Samplers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ompl_interface/ompl_interface_tutorial.html">OMPL Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chomp_planner/chomp_planner_tutorial.html">CHOMP Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stomp_planner/stomp_planner_tutorial.html">STOMP Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trajopt_planner/trajopt_planner_tutorial.html">TrajOpt Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pilz_industrial_motion_planner/pilz_industrial_motion_planner.html">Pilz Industrial Motion Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pilz_industrial_motion_planner/pilz_industrial_motion_planner.html#sequence-of-multiple-segments">Sequence of multiple segments</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Planning Adapter Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-moveit-from-source">Installing MoveIt from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-a-planning-request-adapter-with-your-motion-planner">Use a Planning Request Adapter with your Motion Planner</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#running-ompl-as-a-pre-processor-for-chomp">Running OMPL as a pre-processor for CHOMP</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-chomp-as-a-post-processor-for-stomp">Running CHOMP as a post-processor for STOMP</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-ompl-as-a-pre-processor-for-stomp">Running OMPL as a pre-processor for STOMP</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-stomp-as-a-post-processor-for-chomp">Running STOMP as a post-processor for CHOMP</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#planning-insights-for-different-motion-planners-and-planners-with-planning-adapters">Planning Insights for different motion planners and planners with planning adapters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../persistent_scenes_and_states/persistent_scenes_and_states.html">Warehouse - Persistent Scenes and States</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides/how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_contribute/how_to_contribute.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MoveIt documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Planning Adapter Tutorials</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros-planning/moveit2_tutorials/blob/main/doc/examples/planning_adapters/planning_adapters_tutorial.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <div class="section" id="planning-adapter-tutorials">
<h1>Planning Adapter Tutorials<a class="headerlink" href="#planning-adapter-tutorials" title="Permalink to this headline"></a></h1>
<p>Planning Request Adapters is a concept in MoveIt which can be used to modify the trajectory (pre-processing and/or post-processing) for a motion planner. Some examples of existing planning adapters in MoveIt include AddTimeParameterization, FixWorkspaceBounds, FixStartBounds, FixStartStateCollision, FixStartStatePathConstraints, CHOMPOptimizerAdapter, etc. ! Using the concepts of Planning Adapters, multiple motion planning algorithms can be used in a pipeline to produce robust motion plans. For example, a sample pipeline of motion plans might include an initial plan produced by OMPL which can then be optimized by CHOMP to produce a motion plan which would likely be better than a path produced by OMPL or CHOMP alone. Similarly, using the concept of Planning Adapters, other motion planners can be mixed and matched depending on the environment the robot is operating in. This section provides a step by step tutorial on using a mix and match of different motion planners and also provides insights on when to use which particular motion planners.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline"></a></h2>
<p>If you haven’t already done so, make sure you’ve completed the steps in <a class="reference internal" href="../../tutorials/getting_started/getting_started.html"><span class="doc">Getting Started</span></a>.</p>
<p>You should also have gone through the steps in <a class="reference internal" href="../../tutorials/quickstart_in_rviz/quickstart_in_rviz_tutorial.html"><span class="doc">Visualization with MoveIt RViz Plugin</span></a></p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p>You must have the latest version of MoveIt installed. On ROS Melodic you will need to build MoveIt from source. A build from source is required as CHOMP and STOMP are not a part of the official release yet. It is therefore not included in the binary packages. We will go through the steps for doing this below.</p></li>
<li><p>To use Planning Adapters with your robot you must already have a MoveIt configuration package for your robot already. For example, if you have a Panda robot, it’s probably called <code class="docutils literal notranslate"><span class="pre">panda_moveit_config</span></code>. This is typically built using the <a class="reference internal" href="../setup_assistant/setup_assistant_tutorial.html"><span class="doc">MoveIt Setup Assistant</span></a>.</p></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="installing-moveit-from-source">
<h2>Installing MoveIt from Source<a class="headerlink" href="#installing-moveit-from-source" title="Permalink to this headline"></a></h2>
<p>As you add and remove packages from your workspace you will need to clean your workspace and re-run the command to install new missing dependencies. Clean your workspace to remove references to the system-wide installation of MoveIt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">ws_moveit</span><span class="o">/</span><span class="n">src</span>
<span class="n">catkin</span> <span class="n">clean</span>
</pre></div>
</div>
<p>Now follow the instructions on the MoveIt homepage for <a class="reference external" href="http://moveit.ros.org/install/source/">installing MoveIt Melodic from source</a>. Note that you can skip the <strong>Prerequisites</strong> section since you should already have a Catkin workspace.</p>
<p>Re-source the setup files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">~/</span><span class="n">ws_moveit</span><span class="o">/</span><span class="n">devel</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">bash</span>
</pre></div>
</div>
</div>
<div class="section" id="use-a-planning-request-adapter-with-your-motion-planner">
<h2>Use a Planning Request Adapter with your Motion Planner<a class="headerlink" href="#use-a-planning-request-adapter-with-your-motion-planner" title="Permalink to this headline"></a></h2>
<p>In this section we provide different ways the user can mix and match different motion planners. Major focus of this tutorial is made on OMPL, CHOMP and STOMP as these are the only planners currently supported by MoveIt.</p>
<div class="section" id="running-ompl-as-a-pre-processor-for-chomp">
<h3>Running OMPL as a pre-processor for CHOMP<a class="headerlink" href="#running-ompl-as-a-pre-processor-for-chomp" title="Permalink to this headline"></a></h3>
<p>Here, it is demonstrated that CHOMP can be used as a post-processing optimization technique for plans obtained by other planning algorithms. The intuition behind this is that some randomized planning algorithm produces an initial guess for CHOMP. CHOMP then takes this initial guess and further optimizes the trajectory.
To achieve this, follow the steps:</p>
<ol class="arabic">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">ompl_planning_pipeline.launch</span></code> file in the <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder of your robot. For the Panda robot it is this <a class="reference external" href="https://github.com/ros-planning/panda_moveit_config/blob/melodic-devel/launch/ompl_planning_pipeline.launch.xml">file</a>. Edit this launch file, find the lines where <code class="docutils literal notranslate"><span class="pre">&lt;arg</span> <span class="pre">name=&quot;planning_adapters&quot;&gt;</span></code> is mentioned and change it to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">arg</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;planning_adapters&quot;</span>
     <span class="n">value</span><span class="o">=</span><span class="s2">&quot;default_planner_request_adapters/AddTimeParameterization</span>
            <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixWorkspaceBounds</span>
            <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateBounds</span>
            <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateCollision</span>
            <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStatePathConstraints</span>
            <span class="n">chomp</span><span class="o">/</span><span class="n">OptimizerAdapter</span><span class="s2">&quot; /&gt;</span>
</pre></div>
</div>
</li>
<li><p>The values of the <code class="docutils literal notranslate"><span class="pre">planning_adapters</span></code> is the order in which the mentioned adapters are called / invoked. Order here matters. Inside the CHOMP adapter, a <a class="reference external" href="https://github.com/ros-planning/moveit2/blob/main/moveit_planners/chomp/chomp_optimizer_adapter/src/chomp_optimizer_adapter.cpp#L169">call</a> to OMPL is made before invoking the CHOMP optimization solver, so CHOMP takes the initial path computed by OMPL as the starting point to further optimize it.</p></li>
<li><p>Find the line where <code class="docutils literal notranslate"><span class="pre">&lt;rosparam</span> <span class="pre">command=&quot;load&quot;</span> <span class="pre">file=&quot;$(find</span> <span class="pre">panda_moveit_config)/config/ompl_planning.yaml&quot;/&gt;</span></code> is mentioned and after this line, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">rosparam</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;load&quot;</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;$(find panda_moveit_config)/config/chomp_planning.yaml&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p>These additions will add a CHOMP Optimization adapter and load the corresponding CHOMP planner’s parameters. To do this with your own robot replace <code class="docutils literal notranslate"><span class="pre">panda_moveit_config</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;my_robot&gt;_moveit_config</span></code> of your robot.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">move_group.launch</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder for your robot, make sure that the default planner is <code class="docutils literal notranslate"><span class="pre">ompl</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">chomp_planning.yaml</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/config</span></code> folder for your robot, add the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trajectory_initialization_method</span><span class="p">:</span> <span class="s2">&quot;fillTrajectory&quot;</span>
</pre></div>
</div>
</li>
<li><p>After making these requisite changes to the launch files, open a terminal and execute the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">panda_moveit_config</span> <span class="n">demo</span><span class="o">.</span><span class="n">launch</span> <span class="n">pipeline</span><span class="o">:=</span><span class="n">chomp</span>
</pre></div>
</div>
</li>
</ol>
<p>This will launch RViz, select OMPL in the Motion Planning panel under the Context tab. Set the desired start and goal states by moving the end-effector around in the same way as was done for CHOMP above. Finally click on the Plan button to start planning. The planner will now first run OMPL, then run CHOMP on OMPL’s output to produce an optimized path.</p>
</div>
<div class="section" id="running-chomp-as-a-post-processor-for-stomp">
<h3>Running CHOMP as a post-processor for STOMP<a class="headerlink" href="#running-chomp-as-a-post-processor-for-stomp" title="Permalink to this headline"></a></h3>
<p>Now, it is demonstrated that CHOMP can be used as a post-processing optimization technique for plans obtained by STOMP. The intuition behind this is that STOMP produces an initial path for CHOMP. CHOMP then takes this initial path and further optimizes this trajectory.
To achieve this, follow the steps:</p>
<ol class="arabic">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">stomp_planning_pipeline.launch</span></code> file in the <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder of your robot. For the Panda robot it is <a class="reference external" href="https://github.com/ros-planning/panda_moveit_config/blob/melodic-devel/launch/stomp_planning_pipeline.launch.xml">this</a> file. Edit this launch file, find the lines where <code class="docutils literal notranslate"><span class="pre">&lt;arg</span> <span class="pre">name=&quot;planning_adapters&quot;&gt;</span></code> is mentioned and change it to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">arg</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;planning_adapters&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;default_planner_request_adapters/AddTimeParameterization</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixWorkspaceBounds</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateBounds</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateCollision</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStatePathConstraints</span>
               <span class="n">chomp</span><span class="o">/</span><span class="n">OptimizerAdapter</span><span class="s2">&quot; /&gt;</span>
</pre></div>
</div>
</li>
<li><p>The values of the <code class="docutils literal notranslate"><span class="pre">planning_adapters</span></code> is the order in which the mentioned adapters are called / invoked. Order here matters. Inside the CHOMP adapter, a call to STOMP is made before invoking the CHOMP optimization solver, so CHOMP takes the initial path computed by STOMP as the starting point to further optimize it.</p></li>
<li><p>Find the line where <code class="docutils literal notranslate"><span class="pre">&lt;rosparam</span> <span class="pre">command=&quot;load&quot;</span> <span class="pre">file=&quot;$(find</span> <span class="pre">panda_moveit_config)/config/stomp_planning.yaml&quot;/&gt;</span></code> is mentioned and after this line, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">rosparam</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;load&quot;</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;$(find panda_moveit_config)/config/chomp_planning.yaml&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p>These additions will add a CHOMP Optimization adapter and load the corresponding CHOMP planner’s parameters. To do this with your own robot replace <code class="docutils literal notranslate"><span class="pre">panda_moveit_config</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;my_robot&gt;_moveit_config</span></code> of your robot.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">move_group.launch</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder for your robot, make sure that the default planner is <code class="docutils literal notranslate"><span class="pre">stomp</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">chomp_planning.yaml</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/config</span></code> folder for your robot, add the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trajectory_initialization_method</span><span class="p">:</span> <span class="s2">&quot;fillTrajectory&quot;</span>
</pre></div>
</div>
</li>
<li><p>After making these requisite changes to the launch files, open a terminal and execute the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">panda_moveit_config</span> <span class="n">demo</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
</li>
</ol>
<p>This will launch RViz, select STOMP in the Motion Planning panel under the Context tab. Set the desired start and goal states by moving the end-effector around. Finally click on the Plan button to start planning. The planner will now first run STOMP, then run CHOMP on STOMP’s output to produce an optimized path.</p>
</div>
<div class="section" id="running-ompl-as-a-pre-processor-for-stomp">
<h3>Running OMPL as a pre-processor for STOMP<a class="headerlink" href="#running-ompl-as-a-pre-processor-for-stomp" title="Permalink to this headline"></a></h3>
<p>NOTE: The STOMP Smoothing Adapter is a work in progress.</p>
<p>Here, it is demonstrated that STOMP can be used as a post-processing smoothing technique for plans obtained by other planning algorithms. The intuition behind this is that some randomized planning algorithm produces an initial path for STOMP. STOMP then takes this initial path and further smoothens the trajectory.
To achieve this, follow the steps:</p>
<ol class="arabic">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">ompl_planning_pipeline.launch</span></code> file in the <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder of your robot. For the Panda robot it is this <a class="reference external" href="https://github.com/ros-planning/panda_moveit_config/blob/melodic-devel/launch/ompl_planning_pipeline.launch.xml">file</a>. Edit this launch file, find the lines where <code class="docutils literal notranslate"><span class="pre">&lt;arg</span> <span class="pre">name=&quot;planning_adapters&quot;&gt;</span></code> is mentioned and change it to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">arg</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;planning_adapters&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;default_planner_request_adapters/AddTimeParameterization</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixWorkspaceBounds</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateBounds</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStateCollision</span>
               <span class="n">default_planner_request_adapters</span><span class="o">/</span><span class="n">FixStartStatePathConstraints</span>
               <span class="n">stomp_moveit</span><span class="o">/</span><span class="n">StompSmoothingAdapter</span><span class="s2">&quot; /&gt;</span>
</pre></div>
</div>
</li>
<li><p>The values of the <code class="docutils literal notranslate"><span class="pre">planning_adapters</span></code> is the order in which the mentioned adapters are called / invoked. Order here matters. Inside the STOMP adapter, a call to OMPL is made before invoking the STOMP smoothing solver, so STOMP takes the initial path computed by OMPL as the starting point to further optimize it.</p></li>
<li><p>Find the line where <code class="docutils literal notranslate"><span class="pre">&lt;rosparam</span> <span class="pre">command=&quot;load&quot;</span> <span class="pre">file=&quot;$(find</span> <span class="pre">panda_moveit_config)/config/ompl_planning.yaml&quot;/&gt;</span></code> is mentioned and after this line, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">rosparam</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;load&quot;</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;$(find panda_moveit_config)/config/stomp_planning.yaml&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p>These additions will add a STOMP Smoothing adapter and load the corresponding STOMP planner’s parameters. To do this with your own robot replace <code class="docutils literal notranslate"><span class="pre">panda_moveit_config</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;my_robot&gt;_moveit_config</span></code> of your robot.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">move_group.launch</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder for your robot, make sure that the default planner is <code class="docutils literal notranslate"><span class="pre">ompl</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">stomp_planning.yaml</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/config</span></code> folder for your robot, replace the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialization_method</span><span class="p">:</span> <span class="mi">1</span> <span class="c1">#[1 : LINEAR_INTERPOLATION, 2 : CUBIC_POLYNOMIAL, 3 : MININUM_CONTROL_COST]</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>with this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialization_method</span><span class="p">:</span> <span class="mi">4</span> <span class="c1">#[1 : LINEAR_INTERPOLATION, 2 : CUBIC_POLYNOMIAL, 3 : MININUM_CONTROL_COST, 4 : FILL_TRACJECTORY]</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="7">
<li><p>After making these requisite changes to the launch files, open a terminal and execute the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">panda_moveit_config</span> <span class="n">demo</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
</li>
</ol>
<p>This will launch RViz, select OMPL in the Motion Planning panel under the Context tab. Set the desired start and goal states by moving the end-effector around. Finally click on the Plan button to start planning. The planner will now first run OMPL, then run STOMP on OMPL’s output to produce an smooth path.</p>
</div>
<div class="section" id="running-stomp-as-a-post-processor-for-chomp">
<h3>Running STOMP as a post-processor for CHOMP<a class="headerlink" href="#running-stomp-as-a-post-processor-for-chomp" title="Permalink to this headline"></a></h3>
<p>NOTE: The STOMP Smoothing Adapter is a work in progress.</p>
<p>Here, it is demonstrated that STOMP can be used as a post-processing smoothing technique for plans obtained by CHOMP.
To achieve this, follow the steps:</p>
<ol class="arabic">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">chomp_planning_pipeline.launch</span></code> file in the <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder of your robot. For the Panda robot it is <a class="reference external" href="https://github.com/ros-planning/panda_moveit_config/blob/melodic-devel/launch/chomp_planning_pipeline.launch.xml">this file</a>. Edit this launch file, find the lines where <code class="docutils literal notranslate"><span class="pre">&lt;arg</span> <span class="pre">name=&quot;planning_plugins&quot;&gt;</span></code> is mentioned and add the following lines below it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">arg</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;planning_adapters&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;stomp_moveit/StompSmoothingAdapter&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="n">param</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;request_adapters&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;$(arg planning_adapters)&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p>The values of the <code class="docutils literal notranslate"><span class="pre">planning_adapters</span></code> is the order in which the mentioned adapters are called / invoked. Order here matters. Inside the STOMP adapter, a call to CHOMP is made before invoking the STOMP smoothing solver, so STOMP takes the initial path computed by CHOMP as the starting point to further smoothen it.</p></li>
<li><p>Find the line where <code class="docutils literal notranslate"><span class="pre">&lt;rosparam</span> <span class="pre">command=&quot;load&quot;</span> <span class="pre">file=&quot;$(find</span> <span class="pre">panda_moveit_config)/config/chomp_planning.yaml&quot;/&gt;</span></code> is mentioned and after this line, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">rosparam</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;load&quot;</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;$(find panda_moveit_config)/config/stomp_planning.yaml&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p>These additions will add a STOMP Smoothing adapter and load the corresponding STOMP planner’s parameters. To do this with your own robot replace <code class="docutils literal notranslate"><span class="pre">panda_moveit_config</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;my_robot&gt;_moveit_config</span></code> of your robot.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">move_group.launch</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/launch</span></code> folder for your robot, make sure that the default planner is <code class="docutils literal notranslate"><span class="pre">ompl</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">stomp_planning.yaml</span></code> file of <code class="docutils literal notranslate"><span class="pre">&lt;robot_moveit_config&gt;/config</span></code> folder for your robot, replace the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialization_method</span><span class="p">:</span> <span class="mi">1</span> <span class="c1">#[1 : LINEAR_INTERPOLATION, 2 : CUBIC_POLYNOMIAL, 3 : MININUM_CONTROL_COST]</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>with this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialization_method</span><span class="p">:</span> <span class="mi">4</span> <span class="c1">#[1 : LINEAR_INTERPOLATION, 2 : CUBIC_POLYNOMIAL, 3 : MININUM_CONTROL_COST, 4 : FILL_TRACJECTORY]</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="7">
<li><p>After making these requisite changes to the launch files, open a terminal and execute the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">panda_moveit_config</span> <span class="n">demo</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
</li>
</ol>
<p>This will launch RViz, select CHOMP in the Motion Planning panel under the Context tab. Set the desired start and goal states by moving the end-effector around. Finally click on the Plan button to start planning. The planner will now first run CHOMP, then run STOMP on CHOMP’s output to produce a smooth path.</p>
</div>
</div>
<div class="section" id="planning-insights-for-different-motion-planners-and-planners-with-planning-adapters">
<h2>Planning Insights for different motion planners and planners with planning adapters<a class="headerlink" href="#planning-insights-for-different-motion-planners-and-planners-with-planning-adapters" title="Permalink to this headline"></a></h2>
<p>This section has insights as to when to use which planner and how using certain planning request adapters in a certain pipeline can lead to producing robust paths overall. Here we consider using OMPL, STOMP, CHOMP separately and together to produce robust smooth optimized paths obtained from the planner. For each planner, a basic insight is provided which gives the user an intuition to use a particular planner in a specific situation.</p>
<ul class="simple">
<li><p><strong>CHOMP</strong>: CHOMP is an optimization algorithm which optimizes a given initial trajectory. Based on the environment CHOMP rapidly tries to pull the initial trajectory out of collisions. However an important point to pay attention here is that the parameter <code class="docutils literal notranslate"><span class="pre">ridge_factor</span></code> needs to be more than or equal to 0.001 for avoiding obstacles. Doing this CHOMP is able to find paths while avoiding obstacles. It should be noted here even though CHOMP can avoid obstacles successfully but it fails to provide smooth paths often leading to jerky paths in the presence of obstacles. For CHOMP collision avoidance comes at the cost of the trajectory’s velocity smoothness.</p></li>
<li><p><strong>STOMP</strong>: STOMP produces smooth well behaved collision free paths within reasonable times. The approach relies on generating noisy trajectories to explore the space around an initial (possibly infeasible) trajectory which are then combined to produce an updated trajectory with lower cost.</p></li>
<li><p><strong>OMPL</strong> is a open source library for sampling based / randomized motion planning algorithms as discussed in the ompl planning tutorials. Sampling based algorithms are probabilistically complete: a solution would be eventually found if one exists, however non-existence of a solution cannot be reported. These algorithms are efficient and usually find a solution quickly.</p></li>
</ul>
<p>For more information on each of these motion planners, refer to their individual tutorial pages
<a class="reference internal" href="../ompl_interface/ompl_interface_tutorial.html"><span class="doc">OMPL</span></a>,
<a class="reference internal" href="../chomp_planner/chomp_planner_tutorial.html"><span class="doc">CHOMP</span></a> and
<a class="reference internal" href="../stomp_planner/stomp_planner_tutorial.html"><span class="doc">STOMP</span></a>.</p>
<ul class="simple">
<li><p><strong>OMPL as a pre-processor for CHOMP</strong>: OMPL can used as a base planner to produce an initial motion plan which can act as a initial guess for CHOMP. CHOMP can then produce optimized paths. In most cases, the quality of such a path produced should be better than that produced by OMPL alone or CHOMP alone.</p></li>
<li><p><strong>OMPL as a pre-processor for STOMP</strong>: As stomp can used as a smoothing algorithm, it can be used to smoothen the plans produced by other motion planners. OMPL first produces a path, STOMP can then generate a smoothened version of that path. Such a path in most cases should be better than a path produced by either just OMPL or STOMP alone.</p></li>
<li><p><strong>STOMP as a pre-processor for CHOMP</strong>: For this case, a path can be initially produced by STOMP, CHOMP can then take this as an initial guess and produce an optimized version of the smoothened path produced by STOMP.</p></li>
<li><p><strong>CHOMP as a pre-processor for STOMP</strong>: CHOMP can be used to produce a path and then STOMP can be used to smoothen the path. This helps in getting rid of the jerky motion of the trajectories produced by CHOMP alone in the presence of obstacles.</p></li>
</ul>
<p>A video demonstrating different planners working under different situations will be posted here soon once work on STOMP smoothing adapter is finished.</p>
</div>
</div>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../pilz_industrial_motion_planner/pilz_industrial_motion_planner.html" class="btn btn-neutral float-left" title="Pilz Industrial Motion Planner" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../persistent_scenes_and_states/persistent_scenes_and_states.html" class="btn btn-neutral float-right" title="Warehouse - Persistent Scenes and States" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, PickNik Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108532843-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-108532843-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>