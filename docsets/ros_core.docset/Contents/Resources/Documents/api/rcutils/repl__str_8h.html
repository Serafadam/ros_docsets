<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rcutils: include/rcutils/repl_str.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rcutils
   &#160;<span id="projectnumber">master</span>
   </div>
   <div id="projectbrief">C API providing common utilities and data structures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_6627b286d46f7ece855f6fbde3556e48.html">rcutils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">repl_str.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="allocator_8h_source.html">rcutils/allocator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">rcutils/macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="visibility__control_8h_source.html">rcutils/visibility_control.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for repl_str.h:</div>
<div class="dyncontent">
<div class="center"><img src="repl__str_8h__incl.png" border="0" usemap="#ainclude_2rcutils_2repl__str_8h" alt=""/></div>
<map name="ainclude_2rcutils_2repl__str_8h" id="ainclude_2rcutils_2repl__str_8h">
<area shape="rect" title=" " alt="" coords="280,5,423,47"/>
<area shape="rect" href="allocator_8h.html" title=" " alt="" coords="284,95,419,121"/>
<area shape="rect" href="macros_8h.html" title=" " alt="" coords="72,177,199,203"/>
<area shape="rect" href="visibility__control_8h.html" title=" " alt="" coords="499,348,622,389"/>
<area shape="rect" title=" " alt="" coords="197,355,279,382"/>
<area shape="rect" title=" " alt="" coords="449,177,523,203"/>
<area shape="rect" href="rcutils__ret_8h.html" title=" " alt="" coords="278,169,425,211"/>
<area shape="rect" href="fault__injection_8h.html" title=" " alt="" coords="57,259,203,300"/>
<area shape="rect" title=" " alt="" coords="101,355,167,382"/>
<area shape="rect" title=" " alt="" coords="5,355,76,382"/>
<area shape="rect" href="visibility__control__macros_8h.html" title=" " alt="" coords="490,437,631,479"/>
</map>
</div>
</div>
<p><a href="repl__str_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa181a5c00198a16051e290f8dbe3588"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="repl__str_8h.html#afa181a5c00198a16051e290f8dbe3588">rcutils_repl_str</a> (const char *str, const char *from, const char *to, const <a class="el" href="allocator_8h.html#a2b0c5a16a0401a4afb39d352ff999019">rcutils_allocator_t</a> *allocator)</td></tr>
<tr class="memdesc:afa181a5c00198a16051e290f8dbe3588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replace all the occurrences of one string for another in the given string.  <a href="repl__str_8h.html#afa181a5c00198a16051e290f8dbe3588">More...</a><br /></td></tr>
<tr class="separator:afa181a5c00198a16051e290f8dbe3588"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="afa181a5c00198a16051e290f8dbe3588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa181a5c00198a16051e290f8dbe3588">&#9670;&nbsp;</a></span>rcutils_repl_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* rcutils_repl_str </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="allocator_8h.html#a2b0c5a16a0401a4afb39d352ff999019">rcutils_allocator_t</a> *&#160;</td>
          <td class="paramname"><em>allocator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replace all the occurrences of one string for another in the given string. </p>
<p>Documentation copied from the source with minor tweaks:</p>
<hr  />
<p><b>Description:</b></p>
<p>Replaces in the string <code>str</code> all the occurrences of the source string <code>from</code> with the destination string <code>to</code>. The lengths of the strings <code>from</code> and <code>to</code> may differ. The string <code>to</code> may be of any length, but the string <code>from</code> must be of non-zero length - the penalty for providing an empty string for the <code>from</code> parameter is an infinite loop. In addition, none of the three parameters may be NULL.</p>
<p><b>Returns:</b></p>
<p>The post-replacement string, or NULL if memory for the new string could not be allocated. Does not modify the original string. The memory for the returned post-replacement string may be deallocated with given allocator's deallocate function when it is no longer required.</p>
<p><b>Performance:</b></p>
<p>In case you are curious enough to want to compare this implementation with alternative implementations, you are welcome to compile and run the code in the benchmarking file, <a href="http://creativeandcritical.net/downloads/replacebench.c">replacebench.c</a>. In that file, the above function is included as <code>replace_cache</code>, and the functions originally published on this page as <code>replace_str2</code> and <code>replace_str</code> are included as <code>replace_opt2</code> and <code>replace_opt</code>. Code/functions are included from the comp.lang.c thread, <a href="https://groups.google.com/forum/#!msg/comp.lang.c/sgydS2lDgxc/v2MRxRrAQncJ">how to replace a substring in a string using C?</a>, from answers to the stackoverflow question, <a href="http://stackoverflow.com/questions/779875/what-is-the-function-to-replace-string-in-c">What is the function to replace string in C?</a>, and also from private correspondence. See the comments top of file for instructions on compiling and running it.</p>
<p>In most scenarios, the fastest replacement function, by around 10-20%, is Albert Chan's <code>replace_smart</code>, followed by the above function: <code>repl_str</code> aka <code>replace_cache</code>. There are some scenarios, though, where <code>repl_str</code> is faster than <code>replace_smart</code>, sometimes by up to 200%. These scenarios involve long strings with few matches. Why, if Albert's function is generally slightly faster than the above <code>repl_str</code> function, is it not the focus of this page? Because it generally uses much more memory than <code>repl_str</code>.</p>
<p>The third fastest implementation is typically <code>replace_str2</code> aka <code>replace_opt2</code>. For longer strings in the case in which the lengths of the "from" and "to" strings differ, <code>repl_str</code> aka <code>replace_cache</code> beats it by margins of up to about 80%. For smaller strings, and in the case where the lengths of the "from" and "to" strings are identical, <code>replace_str2</code> aka <code>replace_opt2</code> is faster, by a maximum margin of about 35%, sometimes in those scenarios beating <code>replace_smart</code> too. Some of the other functions are also faster for smaller strings. The even-match point between <code>replace_str2</code> and <code>repl_str</code> (assuming "from" and "to" string lengths differ) depends on how far into the string the final match occurs, how many matches there are, and the comparative lengths of the old and "to" strings, but roughly it occurs for strings of 700-800 bytes in length.</p>
<p>This analysis is based on compiling with <a href="https://gcc.gnu.org/">GCC</a> and testing on a 64-bit Intel platform running Linux, however brief testing with <a href="https://www.visualstudio.com/en-US/products/visual-studio-express-vs">Microsoft Visual C++ 2010 Express</a> (scroll down to "Additional information" at that link) on Windows 7 seemed to produce similar results.</p>
<hr  />
<p>Here continues additional documentation added by OSRF.</p>
<p>The allocator must not be NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>string to have substrings found and replaced within </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>string to match for replacement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>string to replace matched strings with </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allocator</td><td>structure defining functions to be used for allocation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>duplicated <code>str</code> with all matches of <code>from</code> replaced with <code>to</code>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
